<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Seller Dashboard • Manage Products</title>

<style>
  /* ===== BASIC & THEME ===== */
  :root{
    --bg:#f4f6f8;
    --card:#ffffff;
    --muted:#6b7280;
    --accent:#1f6feb;
    --danger:#ef4444;
    --success:#10b981;
    --glass: rgba(31,111,235,0.06);
    --shadow: 0 6px 18px rgba(17,24,39,0.06);
    --radius:12px;
    font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }
  html,body{height:100%;margin:0;background:var(--bg);color:#0f172a}
  a{color:inherit}
  .container{max-width:1100px;margin:28px auto;padding:0 18px;}

  /* ===== HEADER ===== */
  header.header{
    background:linear-gradient(90deg,#fff 0%, #fafafa 100%);
    border-radius:14px;
    padding:18px 20px;
    display:flex;
    gap:16px;
    align-items:center;
    box-shadow:var(--shadow);
  }
  .brand {
    display:flex;align-items:center;gap:12px;flex:1;
  }
  .brand img.logo{width:44px;height:44px;object-fit:contain;border-radius:8px}
  .brand .title {font-weight:700;font-size:18px}
  .brand .subtitle {font-size:12px;color:var(--muted);display:block;margin-top:2px}

  .header-actions {display:flex;gap:10px;align-items:center}
  .btn {
    background:var(--accent);color:white;border:none;padding:9px 12px;border-radius:10px;font-weight:600;cursor:pointer;
    box-shadow: 0 6px 16px rgba(31,111,235,0.14);
  }
  .btn.ghost {background:transparent;color:var(--accent);box-shadow:none;border:1px solid #e6eefc}
  .btn.warn {background:var(--danger);box-shadow:0 6px 16px rgba(239,68,68,0.12)}
  .stat {background:var(--card);padding:12px;border-radius:10px;box-shadow:var(--shadow);display:inline-block;min-width:120px;text-align:center}
  .stat .n {font-weight:700;font-size:18px}
  .stat .l {font-size:12px;color:var(--muted)}

  /* ===== GRID LAYOUT ===== */
  .layout {display:grid;grid-template-columns: 380px 1fr;gap:18px;margin-top:18px;}
  /* Left column (form + stats) */
  .left {
    position:relative;
  }
  .card {
    background:var(--card);padding:16px;border-radius:12px;box-shadow:var(--shadow);
  }

  /* ===== FORM ===== */
  .form .row{display:flex;gap:10px}
  .form input[type="text"], .form input[type="number"], .form select, .form textarea{
    width:100%;padding:10px;border-radius:8px;border:1px solid #e6e9ef;font-size:14px;background:transparent;
  }
  label{display:block;font-size:13px;margin-bottom:6px;color:#0f172a}
  .small {font-size:12px;color:var(--muted);margin-top:6px}
  .controls {display:flex;gap:10px;margin-top:12px}
  .controls .btn {flex:1}

  /* image preview */
  .preview {
    height:120px;border-radius:8px;overflow:hidden;border:1px dashed #e6eefc;background:#fafcff;display:flex;align-items:center;justify-content:center;
    color:var(--muted);font-size:13px;margin-top:10px;
  }
  .preview img{width:100%;height:100%;object-fit:cover}

  /* ===== RIGHT: search + product list ===== */
  .topbar {display:flex;gap:12px;align-items:center;margin-bottom:12px}
  .search {
    display:flex;align-items:center;gap:8px;background:var(--card);padding:8px;border-radius:10px;box-shadow:var(--shadow);flex:1;
  }
  .search input {border:0;outline:0;padding:8px;font-size:14px;width:100%}
  .filter {display:flex;gap:8px;align-items:center}
  .chip {background:var(--glass);padding:8px 10px;border-radius:999px;font-size:13px;color:#0f172a;border:1px solid rgba(31,111,235,0.08);cursor:pointer}
  .chip.active{background:var(--accent);color:white;border:none}

  .list {display:grid;gap:12px}
  .product-row {
    display:flex;gap:12px;align-items:center;padding:12px;border-radius:10px;background:var(--card);box-shadow:var(--shadow);
  }
  .product-row .img{width:84px;height:84px;border-radius:8px;overflow:hidden;background:#f8fafc;flex-shrink:0;border:1px solid #eef2ff}
  .product-row .img img{width:100%;height:100%;object-fit:cover}
  .product-row .meta {flex:1}
  .product-row h4{margin:0;font-size:16px}
  .meta .cat {font-size:12px;color:var(--muted);margin-top:6px}
  .price {font-weight:700;color:#0f172a;margin-top:6px}
  .actions {display:flex;gap:8px}

  .action-btn {padding:8px 10px;border-radius:8px;border:0;cursor:pointer;font-weight:600}
  .action-btn.edit {background: #f59e0b;color:#fff}
  .action-btn.delete {background: #ef4444;color:#fff}
  .action-btn.copy {background:#06b6d4;color:white}

  /* empty state */
  .empty {text-align:center;padding:30px;color:var(--muted);border-radius:10px;background:linear-gradient(180deg,#fff,#fbfdff);box-shadow:var(--shadow)}

  /* responsive */
  @media (max-width: 880px){
    .layout{grid-template-columns:1fr; }
    header.header{flex-direction:column;gap:12px;align-items:flex-start}
  }

  /* toast */
  .toast {
    position:fixed;right:20px;bottom:30px;background:#111;color:white;padding:10px 14px;border-radius:8px;box-shadow:0 8px 30px rgba(2,6,23,0.3);
    transform:translateY(0);opacity:0;transition:all .25s;pointer-events:none;
  }
  .toast.show{opacity:1;pointer-events:auto;transform:translateY(-6px)}
</style>
</head>
<body>

<div class="container">

  <!-- HEADER -->
  <header class="header">
    <div class="brand">
      <img class="logo" src="logo.png" alt="logo" onerror="this.style.display='none'">
      <div>
        <div class="title">Daily Trending Deals</div>
        <div class="subtitle">Seller Dashboard — manage products & offers</div>
      </div>
    </div>

    <div class="header-actions">
      <div class="stat">
        <div class="n" id="totalCount">0</div>
        <div class="l">Total Products</div>
      </div>
      <button class="btn ghost" onclick="goToSite()">View Site</button>
      <button class="btn" onclick="logout()" title="Logout">Logout</button>
    </div>
  </header>

  <!-- LAYOUT -->
  <div class="layout">
    <!-- LEFT: Form + Stats -->
    <div class="left">
      <div class="card form">
        <h3 style="margin:0 0 12px 0">Add / Edit Product</h3>

        <label>Product Name</label>
        <input type="text" id="name" placeholder="E.g. Wireless Earbuds">

        <label>Image URL</label>
        <input type="text" id="img" placeholder="Paste image URL">
        <div class="preview" id="imgPreview">Image preview</div>

        <label>Price (₹)</label>
        <input type="number" id="price" placeholder="999">

        <label>Affiliate Link</label>
        <input type="text" id="link" placeholder="https://">

        <label>Category</label>
        <select id="category">
          <option value="tech">Tech</option>
          <option value="fashion">Fashion</option>
          <option value="home-decor">Home Decor</option>
          <option value="fitness">Fitness</option>
          <option value="beauty">Beauty</option>
        </select>

        <div class="controls">
          <button class="btn" id="saveBtn">Save Product</button>
          <button class="btn ghost" id="clearBtn">Clear</button>
        </div>

        <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
          <div class="small">Tip: paste an image URL and preview will update automatically.</div>
        </div>
      </div>

      <!-- quick category breakdown -->
      <div style="height:12px"></div>
      <div class="card" style="margin-top:12px">
        <h4 style="margin:0 0 10px 0">Category Breakdown</h4>
        <div style="display:flex;gap:10px;flex-wrap:wrap">
          <div class="stat" style="min-width:150px">
            <div class="n" id="countTech">0</div>
            <div class="l">Tech</div>
          </div>
          <div class="stat" style="min-width:150px">
            <div class="n" id="countHome">0</div>
            <div class="l">Home Decor</div>
          </div>
          <div class="stat" style="min-width:150px">
            <div class="n" id="countFit">0</div>
            <div class="l">Fitness</div>
          </div>
        </div>
      </div>
    </div>

    <!-- RIGHT: Search + List -->
    <div>
      <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px">
        <div class="topbar" style="flex:1">
          <div class="search">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35" stroke="#94a3b8" stroke-width="1.8" stroke-linecap="round"/></svg>
            <input id="searchInput" placeholder="Search products by name, category..." />
            <button class="btn ghost" id="btnClearSearch" style="padding:8px 10px">Clear</button>
          </div>

          <div style="width:10px"></div>

          <div class="filter" id="filterBtns">
            <div class="chip active" data-cat="all">All</div>
            <div class="chip" data-cat="tech">Tech</div>
            <div class="chip" data-cat="home-decor">Home Decor</div>
            <div class="chip" data-cat="fitness">Fitness</div>
            <div class="chip" data-cat="beauty">Beauty</div>
            <div class="chip" data-cat="fashion">Fashion</div>
          </div>
        </div>

      </div>

      <div class="card">
        <div id="listWrap">
          <div id="list" class="list"></div>
          <div id="empty" class="empty" style="display:none">No products yet. Add one on the left.</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- toast -->
<div id="toast" class="toast">Saved</div>

<script>
  // ===== AUTH CHECK =====
  if (localStorage.getItem("admin_logged_in") !== "true") {
    window.location.href = "login.html";
  }

  // ===== ELEMENTS =====
  const nameEl = document.getElementById('name');
  const imgEl = document.getElementById('img');
  const priceEl = document.getElementById('price');
  const linkEl = document.getElementById('link');
  const categoryEl = document.getElementById('category');
  const saveBtn = document.getElementById('saveBtn');
  const clearBtn = document.getElementById('clearBtn');
  const previewEl = document.getElementById('imgPreview');

  const listEl = document.getElementById('list');
  const emptyEl = document.getElementById('empty');
  const totalCount = document.getElementById('totalCount');
  const countTech = document.getElementById('countTech');
  const countHome = document.getElementById('countHome');
  const countFit = document.getElementById('countFit');

  const searchInput = document.getElementById('searchInput');
  const filterBtns = document.querySelectorAll('.chip');

  const toast = document.getElementById('toast');

  // ===== DATA =====
  let products = JSON.parse(localStorage.getItem('products')) || [];
  let editIndex = -1;
  let activeFilter = 'all';

  // ===== UTIL =====
  function showToast(text='Saved') {
    toast.textContent = text;
    toast.classList.add('show');
    setTimeout(()=> toast.classList.remove('show'), 2000);
  }

  function saveProducts() {
    localStorage.setItem('products', JSON.stringify(products));
    refreshUI();
  }

  function clearForm() {
    nameEl.value = '';
    imgEl.value = '';
    priceEl.value = '';
    linkEl.value = '';
    categoryEl.value = 'tech';
    editIndex = -1;
    previewEl.innerText = 'Image preview';
    previewEl.style.backgroundImage = '';
  }

  // ===== PREVIEW IMAGE =====
  imgEl.addEventListener('input', () => {
    const url = imgEl.value.trim();
    if (!url) { previewEl.innerHTML = 'Image preview'; return; }
    const img = new Image();
    img.onload = () => { previewEl.innerHTML = ''; previewEl.appendChild(img); }
    img.onerror = () => { previewEl.innerHTML = 'Image not found'; }
    img.src = url;
  });

  // ===== RENDER LIST =====
  function renderList() {
    listEl.innerHTML = '';

    const filtered = products.filter(p => {
      const byFilter = (activeFilter === 'all') || p.category === activeFilter;
      const q = searchInput.value.trim().toLowerCase();
      const bySearch = !q || (p.name.toLowerCase().includes(q) || p.category.toLowerCase().includes(q));
      return byFilter && bySearch;
    });

    if (filtered.length === 0) {
      emptyEl.style.display = 'block';
    } else {
      emptyEl.style.display = 'none';
      filtered.forEach((p, i) => {
        const wrapper = document.createElement('div');
        wrapper.className = 'product-row';

        const imgWrap = document.createElement('div');
        imgWrap.className = 'img';
        const imgTag = document.createElement('img');
        imgTag.src = p.img || 'https://via.placeholder.com/300x200?text=No+Image';
        imgWrap.appendChild(imgTag);

        const meta = document.createElement('div');
        meta.className = 'meta';
        const h = document.createElement('h4');
        h.textContent = p.name;
        const cat = document.createElement('div');
        cat.className = 'cat';
        cat.textContent = p.category;
        const price = document.createElement('div');
        price.className = 'price';
        price.textContent = '₹' + p.price;

        meta.appendChild(h);
        meta.appendChild(cat);
        meta.appendChild(price);

        const actions = document.createElement('div');
        actions.className = 'actions';

        const editBtn = document.createElement('button');
        editBtn.className = 'action-btn edit';
        editBtn.textContent = 'Edit';
        editBtn.onclick = () => startEdit(products.indexOf(p));

        const copyBtn = document.createElement('button');
        copyBtn.className = 'action-btn copy';
        copyBtn.textContent = 'Copy Link';
        copyBtn.onclick = () => {
          navigator.clipboard.writeText(p.link || '');
          showToast('Link copied');
        };

        const delBtn = document.createElement('button');
        delBtn.className = 'action-btn delete';
        delBtn.textContent = 'Delete';
        delBtn.onclick = () => {
          if (confirm('Delete this product?')) {
            const idx = products.indexOf(p);
            if (idx > -1) { products.splice(idx,1); saveProducts(); showToast('Deleted'); }
          }
        };

        actions.appendChild(editBtn);
        actions.appendChild(copyBtn);
        actions.appendChild(delBtn);

        wrapper.appendChild(imgWrap);
        wrapper.appendChild(meta);
        wrapper.appendChild(actions);

        listEl.appendChild(wrapper);
      });
    }
  }

  // ===== STATS =====
  function updateStats() {
    totalCount.textContent = products.length;
    countTech.textContent = products.filter(p => p.category === 'tech').length;
    countHome.textContent = products.filter(p => p.category === 'home-decor').length;
    countFit.textContent = products.filter(p => p.category === 'fitness').length;
  }

  // ===== REFRESH UI =====
  function refreshUI() {
    renderList();
    updateStats();
  }

  // ===== ADD / SAVE =====
  saveBtn.addEventListener('click', () => {
    const name = nameEl.value.trim();
    const img = imgEl.value.trim();
    const price = priceEl.value.trim();
    const link = linkEl.value.trim();
    const category = categoryEl.value;

    if (!name || !img || !price || !link) {
      alert('Please fill all fields (image, name, price, link)');
      return;
    }

    const productObj = { name, img, price, link, category };

    if (editIndex === -1) {
      products.push(productObj);
      showToast('Product added');
    } else {
      products[editIndex] = productObj;
      showToast('Product updated');
    }

    saveProducts();
    clearForm();
  });

  clearBtn.addEventListener('click', () => clearForm());

  // ===== EDIT START =====
  function startEdit(idx) {
    const p = products[idx];
    nameEl.value = p.name;
    imgEl.value = p.img;
    priceEl.value = p.price;
    linkEl.value = p.link;
    categoryEl.value = p.category;
    editIndex = idx;
    previewEl.innerHTML = '';
    const im = new Image();
    im.src = p.img; im.onload = () => previewEl.appendChild(im); im.onerror = () => previewEl.innerText = 'Image not found';
    window.scrollTo({top:0, behavior:'smooth'});
  }

  // ===== SEARCH + FILTER =====
  searchInput.addEventListener('input', () => refreshUI());
  document.getElementById('btnClearSearch').addEventListener('click', () => { searchInput.value=''; refreshUI(); });

  filterBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      filterBtns.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      activeFilter = btn.dataset.cat;
      refreshUI();
    });
  });

  // ===== NAV / LOGOUT / VIEW SITE =====
  function logout(){ localStorage.removeItem('admin_logged_in'); window.location.href='login.html'; }
  function goToSite(){ window.open('index.html','_blank') }

  // ===== INIT =====
  refreshUI();
</script>

</body>
</html>
